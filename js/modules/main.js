import{addDataInPopup}from"./popup.js";const weatherInfo=document.querySelector(".weather-info"),currentTimeWeatherTemp=document.querySelector(".current-time-weather__temp span"),currentTimeWeatherWind=document.querySelector(".current-time-weather__wind span"),currentTimeWeatherHumidinity=document.querySelector(".current-time-weather__humidity span"),currentTimeWeatherFeelsLike=document.querySelector(".current-time-weather__feels-like span"),weekWeatherList=document.querySelector(".week-weather-list"),currentDate=document.querySelector(".current-time-weather__date"),currentLatLng={lat:55.7522,lng:37.6156},API_KEY="5c0dd7e9430af5befd25507b528a6e51",map=L.map("map").setView(currentLatLng,13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(map);const mapPin=L.marker({lat:currentLatLng.lat,lng:currentLatLng.lng},{draggable:!0});mapPin.addTo(map),fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${currentLatLng.lat}&lon=${currentLatLng.lng}&exclude={part}&units=metric&appid=${API_KEY}`).then((e=>{if(e.ok)return e.json();throw e})).then((e=>{showCurrentWeather(e),showWeeklyWeather(e),showHourlyWeather(e),addDataInCurrentWeather(e),addDataInPopup(e)})),mapPin.on("moveend",(e=>{const t=e.target.getLatLng(),n=t.lat,r=t.lng;currentLatLng.lat=n,currentLatLng.lng=r,fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${currentLatLng.lat}&lon=${currentLatLng.lng}&exclude={part}&units=metric&appid=${API_KEY}`).then((e=>{if(e.ok)return e.json();throw e})).then((e=>{showCurrentWeather(e),showWeeklyWeather(e),showHourlyWeather(e),addDataInCurrentWeather(e),addDataInPopup(e)}))}));const showCurrentWeather=e=>{const t=e.current.feels_like;currentTimeWeatherTemp.textContent=`${t.toFixed()}`;const n=e.current.wind_speed;currentTimeWeatherWind.textContent=n;const r=e.current.humidity;currentTimeWeatherHumidinity.textContent=r;const a=e.current.feels_like;currentTimeWeatherFeelsLike.textContent=`${a.toFixed()}`;const o=new Date(1e3*e.current.dt).toLocaleDateString();currentDate.textContent=o},showHourlyWeather=e=>{const t=e.hourly;console.log(t);const n=document.createElement("ul");n.classList.add("hourly-weather-list");const r=new Date(1e3*e.daily[0].dt).toLocaleDateString();for(let e=0;e<t.length;e++){const a=t[e];if(r===new Date(1e3*a.dt).toLocaleDateString()){const e=document.createElement("li"),t=document.createElement("span"),r=document.createElement("span"),o=a.temp,i=new Date(1e3*a.dt);r.classList.add("hourly-weather-list__hours"),t.classList.add("hourly-weather-list__hourly-temp"),t.textContent=`${o.toFixed()}°C`,r.textContent=`${i.toLocaleTimeString()}`,e.appendChild(r),e.appendChild(t),n.appendChild(e)}}return n};function addDataInCurrentWeather(e){const t=document.querySelector(".current-time-weather__hourly"),n=showHourlyWeather(e);t.appendChild(n)}const showWeeklyWeather=e=>{const t=e.daily;weekWeatherList.innerHTML="",t.forEach((e=>{const t=document.createElement("li"),n=document.createElement("div"),r=document.createElement("div"),a=document.createElement("span"),o=document.createElement("span"),i=e.temp.day,c=e.temp.night,l=new Date(1e3*e.dt).toLocaleDateString();a.textContent=`${i.toFixed()}°C днем `,o.textContent=`${c.toFixed()}°C ночью `,n.textContent=l,t.classList.add("week-weather-list__item"),n.classList.add("week-weather-list__date"),r.classList.add("week-weather-list__temp"),r.appendChild(a),r.appendChild(o),t.appendChild(n),t.appendChild(r),weekWeatherList.appendChild(t)}))};navigator.geolocation?window.onload=function(){navigator.geolocation.getCurrentPosition((function(e){mapPin.setLatLng(L.latLng(e.coords.latitude,e.coords.longitude)),map.setView(L.latLng(e.coords.latitude,e.coords.longitude),13)}))}:console.log("Geolocation is not supported for this Browser/OS version yet.");export{showHourlyWeather};